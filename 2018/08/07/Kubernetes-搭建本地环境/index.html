<!DOCTYPE HTML><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1,minimum-scale=1"><meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"><meta http-equiv="Cache-Control" content="no-siteapp"><meta http-equiv="Cache-Control" content="no-transform"><meta name="renderer" content="webkit|ie-comp|ie-stand"><meta name="apple-mobile-web-app-capable" content="ChaosCoffee&#39; blog"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=no,email=no,adress=no"><meta name="browsermode" content="application"><meta name="screen-orientation" content="portrait"><link rel="dns-prefetch" href="https://chaoscoffee.github.io"><meta name="robots" content="all"><meta name="google" content="all"><meta name="googlebot" content="all"><meta name="verify" content="all"><title>Kubernetes-搭建本地环境 | ChaosCoffee&#39; blog</title><link rel="alternate" href="/atom.xml" title="ChaosCoffee&#39; blog" type="application/atom+xml"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/css/bootstrap.min.css?rev=01db7b9bef05ad753ff3280573311707"><link rel="stylesheet" href="/css/font-awesome.min.css?rev=7d7c67beb5a3ece63f0a947be957099b"><link rel="stylesheet" href="/css/style.css?rev=5e007e24b2eddf2cb1d77fa3b2664f4b"><div class="hide"><script type="text/javascript">var cnzz_protocol="https:"==document.location.protocol?" https://":" http://";document.write(unescape("%3Cspan class='cnzz_stat_icon_1263868967 hide' %3E%3Cscript%20src%3D%22https%3A%2F%2Fs95.cnzz.com%2Fz_stat.php%3Fweb_id%3D1272564536%22%3E%3C%2Fscript%3E%3C/span%3E%3Cscript src='"+cnzz_protocol+"s19.cnzz.com/z_stat.php%3Fid%3D1263868967%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"))</script></div></head><!--[if lte IE 8]><style>
    html{ font-size: 1em }
</style><![endif]--><!--[if lte IE 9]><div style="ie">你使用的浏览器版本过低，为了你更好的阅读体验，请更新浏览器的版本或者使用其他现代浏览器，比如Chrome、Firefox、Safari等。</div><![endif]--><body><header class="main-header" style="background-image:url(/img/banner2.jpg)"><div class="main-header-box"><a class="header-avatar" href="/" title="ChaoCofee"><img src="/img/avatar.jpg" alt="logo头像" class="img-responsive center-block"></a><div class="branding"><img src="/img/branding.png" alt="Snippet 博客主题" class="img-responsive center-block"></div></div></header><nav class="main-navigation"><div class="container"><div class="row"><div class="col-sm-12"><div class="navbar-header"><span class="nav-toggle-button collapsed pull-right" data-toggle="collapse" data-target="#main-menu" id="mnav"><span class="sr-only"></span><i class="fa fa-bars"></i></span> <a class="navbar-brand" href="https://chaoscoffee.github.io">ChaosCoffee&#39; blog</a></div><div class="collapse navbar-collapse" id="main-menu"><ul class="menu"><li role="presentation" class="text-center"><a href="/"><i class="fa fa-home"></i> Home</a></li><li role="presentation" class="text-center"><a href="/categories/programmes/"><i class="fa fa-github"></i> Programmes</a></li><li role="presentation" class="text-center"><a href="/categories/tools/"><i class="fa fa-wrench"></i> Tools</a></li><li role="presentation" class="text-center"><a href="/categories/interview/"><i class="fa fa-user"></i> 求职面试</a></li><li role="presentation" class="text-center"><a href="/archives/"><i class="fa fa-calendar"></i> 时间轴</a></li></ul></div></div></div></div></nav><section class="content-wrap"><div class="container"><div class="row"><main class="col-md-8 main-content m-post"><p id="process"></p><article class="post"><div class="post-head"><h1 id="Kubernetes-搭建本地环境">Kubernetes-搭建本地环境</h1><div class="post-meta"><span class="categories-meta fa-wrap"><i class="fa fa-folder-open-o"></i> <a href="/categories/kubernetes">kubernetes</a></span><span class="fa-wrap"><i class="fa fa-tags"></i> <span class="tags-meta"><a href="/tags/kubernetes" title="kubernetes">kubernetes</a></span></span><span class="fa-wrap"><i class="fa fa-clock-o"></i> <span class="date-meta">2018/08/07</span></span></div></div><div class="post-body post-content"><h1 id="kubernetes-搭建本地环境"><a href="#kubernetes-搭建本地环境" class="headerlink" title="kubernetes 搭建本地环境"></a>kubernetes 搭建本地环境</h1><ul><li><a href="#kubernetes-搭建本地环境">kubernetes 搭建本地环境</a><ul><li><a href="#chocolatey安装">Chocolatey安装</a></li><li><a href="#更换镜像">更换镜像</a></li><li><a href="#安装virtualbox">安装virtualbox</a><ul><li><a href="#添加所需要的库">添加所需要的库</a></li><li><a href="#更新yum缓存">更新yum缓存</a></li><li><a href="#安装virtualbox-1">安装virtualbox</a></li><li><a href="#安装-dkms更新内核">安装 DKMS、更新内核</a></li><li><a href="#开启虚拟机虚化">开启虚拟机虚化</a></li></ul></li><li><a href="#安装-docker">安装 docker</a></li><li><a href="#安装kubectl">安装kubectl</a><ul><li><a href="#修改kubernetesrepo">修改kubernetes.repo</a></li></ul></li><li><a href="#安装kubectlkubeletkubeadm所有节点">安装kubectl、kubelet、kubeadm(所有节点)</a></li><li><a href="#minikube">Minikube</a><ul><li><a href="#下载安装">下载安装</a></li><li><a href="#配置环境变量">配置环境变量</a></li><li><a href="#启动">启动</a></li><li><a href="#停止">停止</a></li><li><a href="#删除">删除</a></li><li><a href="#访问">访问</a></li></ul></li><li><a href="#kubernetes部署">Kubernetes部署</a><ul><li><a href="#拉取镜像">拉取镜像</a></li><li><a href="#发布服务">发布服务</a><ul><li><a href="#命令行模式">命令行模式</a></li><li><a href="#声明式模式推荐">声明式模式(推荐)</a></li></ul></li><li><a href="#查看pod">查看Pod</a></li><li><a href="#查看service">查看service</a></li><li><a href="#查看日志">查看日志</a></li><li><a href="#更新配置">更新配置</a></li><li><a href="#销毁服务">销毁服务</a></li><li><a href="#客户端访问">客户端访问</a></li><li><a href="#查看master">查看master</a></li><li><a href="#查看config">查看config</a></li></ul></li><li><a href="#问题">问题</a><ul><li><a href="#如何关闭防火墙">如何关闭防火墙？</a></li><li><a href="#minikube镜像下载不了">minikube镜像下载不了？</a></li></ul></li><li><a href="#参考文献">参考文献</a></li></ul></li></ul><h2 id="Chocolatey安装"><a href="#Chocolatey安装" class="headerlink" title="Chocolatey安装"></a>Chocolatey安装</h2><p>安装 <code>Chocolatey</code><br>管理员身份运行cmd.exe</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@&quot;%SystemRoot%\System32\WindowsPowerShell\v1.0\powershell.exe&quot; -NoProfile -InputFormat None -ExecutionPolicy Bypass -Command &quot;iex ((New-Object System.Net.WebClient).DownloadString(&apos;https://chocolatey.org/install.ps1&apos;))&quot; &amp;&amp; SET &quot;PATH=%PATH%;%ALLUSERSPROFILE%\chocolatey\bin&quot;</span><br></pre></td></tr></table></figure><blockquote><p>choco</p></blockquote><blockquote><p>choco upgrade chocolatey</p></blockquote><blockquote><p>choco install kubernetes-cli</p></blockquote><h2 id="更换镜像"><a href="#更换镜像" class="headerlink" title="更换镜像"></a>更换镜像</h2><p>[防火墙]</p><blockquote><p>$ cd /etc/sysconfig/network-scripts<br>$ service network restart</p></blockquote><p>[更换yum]</p><blockquote><p>$ wget -O /etc/yum.repos.d/CentOS-Base.repo <a href="http://mirrors.aliyun.com/repo/Centos-7.repo" target="_blank" rel="noopener">http://mirrors.aliyun.com/repo/Centos-7.repo</a></p></blockquote><blockquote><p>$ yum makecache</p></blockquote><blockquote><p>$ yum repolist</p></blockquote><blockquote><p>$ yum repoinfo</p></blockquote><h2 id="安装virtualbox"><a href="#安装virtualbox" class="headerlink" title="安装virtualbox"></a>安装virtualbox</h2><h3 id="添加所需要的库"><a href="#添加所需要的库" class="headerlink" title="添加所需要的库"></a>添加所需要的库</h3><blockquote><p>$ yum install wget<br>$ cd /etc/yum.repos.d/<br>$ wget <a href="http://download.virtualbox.org/virtualbox/rpm/rhel/virtualbox.repo" target="_blank" rel="noopener">http://download.virtualbox.org/virtualbox/rpm/rhel/virtualbox.repo</a></p></blockquote><p>virtualbox.repo内容如下:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[virtualbox]</span><br><span class="line">name=Oracle Linux / RHEL / CentOS-$releasever / $basearch - VirtualBox</span><br><span class="line">baseurl=http://download.virtualbox.org/virtualbox/rpm/el/$releasever/$basearch</span><br><span class="line">enabled=1</span><br><span class="line">gpgcheck=1</span><br><span class="line">repo_gpgcheck=1</span><br><span class="line">gpgkey=https://www.virtualbox.org/download/oracle_vbox.asc</span><br></pre></td></tr></table></figure><h3 id="更新yum缓存"><a href="#更新yum缓存" class="headerlink" title="更新yum缓存"></a>更新yum缓存</h3><blockquote><p>$ yum clean all</p></blockquote><blockquote><p>$ yum makecache</p></blockquote><h3 id="安装virtualbox-1"><a href="#安装virtualbox-1" class="headerlink" title="安装virtualbox"></a>安装virtualbox</h3><blockquote><p>$ yum install VirtualBox-5.1</p></blockquote><h3 id="安装-DKMS、更新内核"><a href="#安装-DKMS、更新内核" class="headerlink" title="安装 DKMS、更新内核"></a>安装 DKMS、更新内核</h3><blockquote><p>$ yum -y install gcc make glibc kernel-headers kernel-devel dkms<br>$ yum -y update kernel<br>$ reboot</p></blockquote><h3 id="开启虚拟机虚化"><a href="#开启虚拟机虚化" class="headerlink" title="开启虚拟机虚化"></a>开启虚拟机虚化</h3><p>需要在BIOS里开启虚拟机虚化</p><h2 id="安装-docker"><a href="#安装-docker" class="headerlink" title="安装 docker"></a>安装 docker</h2><blockquote><p>$ yum search docker<br>$ yum install -y docker<br>$ systemctl start docker</p></blockquote><h2 id="安装kubectl"><a href="#安装kubectl" class="headerlink" title="安装kubectl"></a>安装kubectl</h2><h3 id="修改kubernetes-repo"><a href="#修改kubernetes-repo" class="headerlink" title="修改kubernetes.repo"></a>修改kubernetes.repo</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[kubernetes]</span><br><span class="line">name=Kubernetes</span><br><span class="line">baseurl=https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64</span><br><span class="line">enabled=1</span><br><span class="line">gpgcheck=0</span><br></pre></td></tr></table></figure><h2 id="安装kubectl、kubelet、kubeadm-所有节点"><a href="#安装kubectl、kubelet、kubeadm-所有节点" class="headerlink" title="安装kubectl、kubelet、kubeadm(所有节点)"></a>安装kubectl、kubelet、kubeadm(所有节点)</h2><ul><li>kubelet: 运行在cluster所有节点上,负责启动POD和容器</li><li>kubeadm: 用于初始化cluster</li><li>kubectl: kubectl是kubenetes命令行工具，通过kubectl可以部署和管理应用，查看各种资源，创建，删除和更新组件</li></ul><blockquote><p>$ yum install -y kubectl<br>$ yum install -y kubelet<br>$ yum install -y kubeadm</p></blockquote><h2 id="Minikube"><a href="#Minikube" class="headerlink" title="Minikube"></a>Minikube</h2><p>Minikube 是一个允许开发人员在本地使用和运行 Kubernetes 集群的工具</p><h3 id="下载安装"><a href="#下载安装" class="headerlink" title="下载安装"></a>下载安装</h3><p>下载minikube<br>[Linux]</p><blockquote><p>$ curl -Lo minikube <a href="http://kubernetes.oss-cn-hangzhou.aliyuncs.com/minikube/releases/v0.28.0/minikube-linux-amd64" target="_blank" rel="noopener">http://kubernetes.oss-cn-hangzhou.aliyuncs.com/minikube/releases/v0.28.0/minikube-linux-amd64</a> &amp;&amp; chmod +x minikube &amp;&amp; sudo mv minikube /usr/local/bin/</p></blockquote><p>[Windows]</p><blockquote><p>$ choco install minikube</p></blockquote><h3 id="配置环境变量"><a href="#配置环境变量" class="headerlink" title="配置环境变量"></a>配置环境变量</h3><p>MINIKUBE_HOME=D:\kuberbnetes<br>MINIKUBE_WANTREPORTERRORPROMPT=false<br>MINIKUBE_WANTUPDATENOTIFICATION=false</p><h3 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h3><blockquote><p>$ minikube start –registry-mirror=<a href="https://registry.docker-cn.com" target="_blank" rel="noopener">https://registry.docker-cn.com</a><br>–vm-driver=none //不用虚拟机</p></blockquote><blockquote><p>$ minikube start –vm-driver=virtualbox –registry-mirror=<a href="https://registry.docker-cn.com" target="_blank" rel="noopener">https://registry.docker-cn.com</a></p></blockquote><blockquote><p>$ minikube start –vm-driver=hyperv –registry-mirror=<a href="https://registry.docker-cn.com" target="_blank" rel="noopener">https://registry.docker-cn.com</a></p></blockquote><p>Windows<br>windows10可以使用自带hyper-v<br>参考启动配置:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ minikube start --vm-driver=hyperv --hyperv-virtual-switch=minikube-Switch --registry-mirror=https://registry.docker-cn.com</span><br><span class="line"></span><br><span class="line">$ minikube start --vm-driver=&quot;hyperv&quot; --memory=4096 --cpus=4 --hyperv-virtual-switch=&quot;minikube-Switch&quot; --v=7 --alsologtostderr</span><br><span class="line"></span><br><span class="line">$ minikube start --vm-driver=&quot;hyperv&quot; --hyperv-virtual-switch=&quot;minikube-Switch&quot; --v=7 --alsologtostderr</span><br></pre></td></tr></table></figure><p>作者配置(通过测试)</p><blockquote><p>$ minikube start –vm-driver “hyperv” –hyperv-virtual-switch “minikube-Switch” –v 9999 –alsologtostderr</p></blockquote><h3 id="停止"><a href="#停止" class="headerlink" title="停止"></a>停止</h3><blockquote><p>$ minikube stop</p></blockquote><h3 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h3><p>启动失败需要rm -rf 删除 ./minikube下的内容,再使用</p><blockquote><p>$ minikube delete</p></blockquote><p>最后重新执行启动命令</p><h3 id="访问"><a href="#访问" class="headerlink" title="访问"></a>访问</h3><blockquote><p>$ minikube dashboard<br>$ minikube service hello-node</p></blockquote><hr><h2 id="Kubernetes部署"><a href="#Kubernetes部署" class="headerlink" title="Kubernetes部署"></a>Kubernetes部署</h2><h3 id="拉取镜像"><a href="#拉取镜像" class="headerlink" title="拉取镜像"></a>拉取镜像</h3><blockquote><p>$ docker pull chenliujin/defaultbackend:1.4<br>$ docker tag chenliujin/defaultbackend:1.4 gcr.io/google_containers/defaultbackend:1.4</p></blockquote><h3 id="发布服务"><a href="#发布服务" class="headerlink" title="发布服务"></a>发布服务</h3><p>这里用NodePort对外提供服务</p><h4 id="命令行模式"><a href="#命令行模式" class="headerlink" title="命令行模式"></a>命令行模式</h4><blockquote><p>$kubectl run hello-minikube –image=k8s.gcr.io/echoserver:1.4 –port=8081<br>$kubectl expose deployment hello-minikube –type=NodePort</p></blockquote><blockquote><p>$ kubectl run –image=nginx nginx-app –port=80<br>$ kubectl expose deployment nginx-app –port=80 –name=nginx-http –type=NodePort</p></blockquote><p>设置镜像</p><blockquote><p>$ kubectl set image deployment/hello-node hello-node=hello-node:v2</p></blockquote><h4 id="声明式模式-推荐"><a href="#声明式模式-推荐" class="headerlink" title="声明式模式(推荐)"></a>声明式模式(推荐)</h4><p>推荐使用</p><blockquote><p>$ kubectl create -f nginx-rc.yaml</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">apiVersion: v1 </span><br><span class="line">kind: ReplicationController</span><br><span class="line">metadata:</span><br><span class="line">name: nginx-rc</span><br><span class="line">spec:</span><br><span class="line">replicas: 2</span><br><span class="line">selector:</span><br><span class="line">app: nginx</span><br><span class="line">template:</span><br><span class="line">metadata:</span><br><span class="line">labels:</span><br><span class="line">app: nginx</span><br><span class="line">spec:</span><br><span class="line">containers:</span><br><span class="line">- name: nginx</span><br><span class="line">image: nginx</span><br><span class="line">ports:</span><br><span class="line">- containerPort: 80</span><br></pre></td></tr></table></figure><blockquote><p>$ kubectl create -f nginx-service.yaml</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">apiVersion: v1 </span><br><span class="line">kind: Service</span><br><span class="line">metadata:</span><br><span class="line">name: nginx-service</span><br><span class="line">spec:</span><br><span class="line">ClusterIP: None</span><br><span class="line">ports:</span><br><span class="line">- port: 80</span><br><span class="line">targetPort: 80</span><br><span class="line">protocol: TCP</span><br><span class="line">selector:</span><br><span class="line">app: nginx</span><br></pre></td></tr></table></figure><h3 id="查看Pod"><a href="#查看Pod" class="headerlink" title="查看Pod"></a>查看Pod</h3><p>查看默认的pod</p><blockquote><p>$ kubectl get pods</p></blockquote><p>查看所有namespace的pod数据</p><blockquote><p>$ kubectl get pods –all-namespaces -o wide</p></blockquote><p>请求部署的service</p><blockquote><p>$ curl $(minikube service hello-minikube –url)</p></blockquote><h3 id="查看service"><a href="#查看service" class="headerlink" title="查看service"></a>查看service</h3><blockquote><p>$ kubectl get services<br>$ kubectl get service –all-namespaces</p></blockquote><h3 id="查看日志"><a href="#查看日志" class="headerlink" title="查看日志"></a>查看日志</h3><p>$ minikube logs</p><h3 id="更新配置"><a href="#更新配置" class="headerlink" title="更新配置"></a>更新配置</h3><blockquote><p>$ kubectl replace -f rc-nginx.yaml</p></blockquote><h3 id="销毁服务"><a href="#销毁服务" class="headerlink" title="销毁服务"></a>销毁服务</h3><blockquote><p>$ kubectl delete service nginx-service<br>$ kubectl delete deployment nginx-pod<br>$ kubectl delete rc nginx-service</p></blockquote><h3 id="客户端访问"><a href="#客户端访问" class="headerlink" title="客户端访问"></a>客户端访问</h3><blockquote><p>$ curl ‘192.168.64.2:30716’<br>$ minikube service nginx-http<br>访问部署service<br>$ minikube service hello-node</p></blockquote><h3 id="查看master"><a href="#查看master" class="headerlink" title="查看master"></a>查看master</h3><blockquote><p>$ kubectl cluster-info</p></blockquote><h3 id="查看config"><a href="#查看config" class="headerlink" title="查看config"></a>查看config</h3><blockquote><p>$ kubectl config view</p></blockquote><hr><h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><h3 id="如何关闭防火墙？"><a href="#如何关闭防火墙？" class="headerlink" title="如何关闭防火墙？"></a>如何关闭防火墙？</h3><p>关闭防火墙</p><blockquote><p>$ systemctl stop firewalld //临时关闭<br>$ systemctl disable firewalld //禁止开机启动<br>$ Removed symlink /etc/systemd/system/multi-user.target.wants/firewalld.service.<br>$ Removed symlink /etc/systemd/system/dbus-org.fedoraproject.FirewallD1.service.</p></blockquote><p>访问: <a href="http://127.0.0.1:8001/ui" target="_blank" rel="noopener">http://127.0.0.1:8001/ui</a></p><h3 id="minikube镜像下载不了？"><a href="#minikube镜像下载不了？" class="headerlink" title="minikube镜像下载不了？"></a>minikube镜像下载不了？</h3><p>下载不了如何解决<br>说明：由于GFW的原因下载不下来的，都可以到时速云去下载相应的镜像（只要把grc.io换成index.tenxcloud.com就可以了。<br>或者用私用镜像仓库，tag之后上传到之后看到的镜像是自己私有镜像仓库的。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo docker pull registry.cn-hangzhou.aliyuncs.com/google_containers/pause-amd64:3.1 &amp;&amp; sudo docker tag registry.cn-hangzhou.aliyuncs.com/google_containers/pause-amd64:3.1 k8s.gcr.io/pause-amd64:3.1 &amp;&amp; sudo /usr/bin/kubeadm init --config /var/lib/kubeadm.yaml --ignore-preflight-errors=DirAvailable--etc-kubernetes-manifests --ignore-preflight-errors=DirAvailable--data-minikube --ignore-preflight-errors=Port-10250 --ignore-preflight-errors=FileAvailable--etc-kubernetes-manifests-kube-scheduler.yaml --ignore-preflight-errors=FileAvailable--etc-kubernetes-manifests-kube-apiserver.yaml --ignore-preflight-errors=FileAvailable--etc-kubernetes-manifests-kube-controller-manager.yaml --ignore-preflight-errors=FileAvailable--etc-kubernetes-manifests-etcd.yaml --ignore-preflight-errors=Swap --ignore-preflight-errors=CRI</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ minikube ssh</span><br><span class="line">$ docker pull registry.cn-hangzhou.aliyuncs.com/google-containers/pause-amd64:3.0</span><br><span class="line">$ docker tag registry.cn-hangzhou.aliyuncs.com/google-containers/pause-amd64:3.0 gcr.io/google_containers/pause-amd64:3.0</span><br></pre></td></tr></table></figure><h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><p>[参考]</p><p><a href="https://yq.aliyun.com/articles/221687" target="_blank" rel="noopener">Kubernetes本地实验环境</a><br><a href="https://www.imooc.com/article/details/id/23785" target="_blank" rel="noopener">通过Minikube快速搭建一个本地的Kubernetes单节点环境</a></p></div><div class="post-footer"><div>转载声明：商业转载请联系作者获得授权,非商业转载请注明出处 © <a href="" target="_blank">ChaosCoffee</a></div><div></div></div></article><div class="article-nav prev-next-wrap clearfix"><a href="/2018/08/10/Ingress-实践/" class="pre-post btn btn-default" title="Ingress-实践"><i class="fa fa-angle-left fa-fw"></i> <span class="hidden-lg">上一篇</span> <span class="hidden-xs">Ingress-实践</span></a> <a href="/2018/08/07/Kubernetes-介绍/" class="next-post btn btn-default" title="Kubernetes-介绍"><span class="hidden-lg">下一篇</span> <span class="hidden-xs">Kubernetes-介绍</span><i class="fa fa-angle-right fa-fw"></i></a></div></main><aside id="article-toc" role="navigation" class="col-md-4"><div class="widget"><h3 class="title">文章目录</h3><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#kubernetes-搭建本地环境"><span class="toc-text">kubernetes 搭建本地环境</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Chocolatey安装"><span class="toc-text">Chocolatey安装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#更换镜像"><span class="toc-text">更换镜像</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#安装virtualbox"><span class="toc-text">安装virtualbox</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#添加所需要的库"><span class="toc-text">添加所需要的库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#更新yum缓存"><span class="toc-text">更新yum缓存</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#安装virtualbox-1"><span class="toc-text">安装virtualbox</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#安装-DKMS、更新内核"><span class="toc-text">安装 DKMS、更新内核</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#开启虚拟机虚化"><span class="toc-text">开启虚拟机虚化</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#安装-docker"><span class="toc-text">安装 docker</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#安装kubectl"><span class="toc-text">安装kubectl</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#修改kubernetes-repo"><span class="toc-text">修改kubernetes.repo</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#安装kubectl、kubelet、kubeadm-所有节点"><span class="toc-text">安装kubectl、kubelet、kubeadm(所有节点)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Minikube"><span class="toc-text">Minikube</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#下载安装"><span class="toc-text">下载安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#配置环境变量"><span class="toc-text">配置环境变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#启动"><span class="toc-text">启动</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#停止"><span class="toc-text">停止</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#删除"><span class="toc-text">删除</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#访问"><span class="toc-text">访问</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Kubernetes部署"><span class="toc-text">Kubernetes部署</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#拉取镜像"><span class="toc-text">拉取镜像</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#发布服务"><span class="toc-text">发布服务</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#命令行模式"><span class="toc-text">命令行模式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#声明式模式-推荐"><span class="toc-text">声明式模式(推荐)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#查看Pod"><span class="toc-text">查看Pod</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#查看service"><span class="toc-text">查看service</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#查看日志"><span class="toc-text">查看日志</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#更新配置"><span class="toc-text">更新配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#销毁服务"><span class="toc-text">销毁服务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#客户端访问"><span class="toc-text">客户端访问</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#查看master"><span class="toc-text">查看master</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#查看config"><span class="toc-text">查看config</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#问题"><span class="toc-text">问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#如何关闭防火墙？"><span class="toc-text">如何关闭防火墙？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#minikube镜像下载不了？"><span class="toc-text">minikube镜像下载不了？</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考文献"><span class="toc-text">参考文献</span></a></li></ol></li></ol></div></aside></div></div></section><footer class="main-footer"><div class="container"><div class="row"><div style="text-align:center"><script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.3.0/css/font-awesome.min.css">Total&nbsp;<span id="busuanzi_value_site_pv"></span>&nbsp;views. 您是本站的第<span id="busuanzi_value_site_uv"></span>个小伙伴&nbsp;|<span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span> &nbsp;Hits</div></div></div></footer><a id="back-to-top" class="icon-btn hide"><i class="fa fa-chevron-up"></i></a><div class="copyright"><div class="container"><div class="row"><div class="col-sm-12"><span>Copyright &copy; 2017</span> | <span>Powered by <a href="//hexo.io" class="copyright-links" target="_blank" rel="nofollow">Hexo</a></span> | <span>Theme by <a href="//github.com/shenliyang/hexo-theme-snippet.git" class="copyright-links" target="_blank" rel="nofollow">Snippet</a></span></div></div></div></div><script src="/js/app.js?rev=26a1b6fecd389c0121b7027a299aa7c0"></script></body></html>